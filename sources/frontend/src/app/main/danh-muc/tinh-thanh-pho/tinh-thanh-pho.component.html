<page-header [title]="'::DanhMucs' | abpLocalization" [description]="'::DanhMucs.TinhThanhPho' | abpLocalization"></page-header>

<div class="card">
  <div class="card-header">
    <div class="row">
      <div class="col col-md-6">
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-search"></i></span>
          <input #searchInput type="text" class="form-control" placeholder="Tìm kiếm" (keyup)="search()" />
        </div>
      </div>

      <div class="text-end col col-md-6">
        <div class="text-lg-end">
          <button *abpPermission="'Cts.DanhMucs.TinhThanhPho.Create'" id="create" class="btn btn-primary" type="button" (click)="createTinhThanhPho()">
            <i class="fa fa-plus me-1"></i>
            <span>{{ '::CreateNew' | abpLocalization }}</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="card-body">
    <p-table
      [value]="tinhThanhPho.items"
      [lazy]="true"
      [rows]="pageSize"
      [first]="(page - 1) * pageSize"
      [totalRecords]="tinhThanhPho?.totalCount || 0"
      [rowsPerPageOptions]="[5, 10, 20, 50]"
      (onLazyLoad)="onPageChange($event)"
      paginator = "false"
      >
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 50px">#</th>
          <th pSortableColumn="TenTinhThanhPho" >{{ '::TenTinhThanhPho' | abpLocalization }}<p-sortIcon field="TenTinhThanhPho" />
          </th>
          <th pSortableColumn="maTinhThanhPho">{{ '::MaTinhThanhPho' | abpLocalization }}<p-sortIcon field="maTinhThanhPho" />
          </th>
          <th pSortableColumn="trangThai" >{{ '::TrangThai' | abpLocalization }}<p-sortIcon field="trangThai" />
          </th>
          <th pSortableColumn="ghiChu">{{ '::GhiChu' | abpLocalization }}<p-sortIcon field="ghiChu" />
          </th>
          <th style="width: 150px">{{ '::Actions' | abpLocalization }}</th>
        </tr>
      </ng-template>
  
      <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">
        <tr>
          <td>{{ (page - 1) * pageSize + rowIndex + 1 }}</td>
          <td>{{ row.tenTinhThanhPho }}</td>
          <td>{{ row.maTinhThanhPho }}</td>
          <td>{{ row.trangThai.toString() === '1' ? 'Hoạt động' : 'Không hoạt động' | abpLocalization }}</td>
          <td>{{ row.ghiChu }}</td>
          <td>
            <div ngbDropdown container="body" class="d-inline-block">
              <button class="btn btn-primary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" ngbDropdownToggle>
                <i class="fa fa-cog me-1"></i>
              </button>
              <div ngbDropdownMenu>
                <button *abpPermission="'Cts.DanhMucs.TinhThanhPho.Edit'" ngbDropdownItem (click)="editTinhThanhPho(row.id)">
                  {{ '::Edit' | abpLocalization }}
                </button>
                <button *abpPermission="'Cts.DanhMucs.TinhThanhPho.Delete'" ngbDropdownItem (click)="delete(row.id)">
                  {{ '::Delete' | abpLocalization }}
                </button>
              </div>
            </div>
          </td>
        </tr>
      </ng-template>
      
    </p-table>
    <div class="d-flex justify-content-end" >
      <div class="d-flex justify-content-end" style="margin-top: 14px;">
        Tổng cộng: {{ tinhThanhPho?.totalCount || 0 }}
      </div>
      <p-paginator
        [rows]="pageSize"
        [first]="(page - 1) * pageSize"
        [totalRecords]="tinhThanhPho?.totalCount || 0"
        [rowsPerPageOptions]="[5, 10, 20, 50]"
        (onPageChange)="onPageChange($event)"
      >
      </p-paginator>
    </div>
  </div>  
  
</div>

<abp-modal [(visible)]="isModalOpen">
    <ng-template #abpHeader>    
        <h3>{{ (selectedTinhThanhPho.id ? '::Sửa Tỉnh/Thành phố' : '::Thêm mới Tỉnh/Thành phố' ) | abpLocalization }}</h3>
    </ng-template>

    <ng-template #abpBody>
        <form [formGroup]="form" (ngSubmit)="save()">
            <div class="mt-2">
                <label for="tenTinhThanhPho">{{ '::TenTinhThanhPho' | abpLocalization }}</label><span> * </span>
                <input type="text" class="form-control" id="tenTinhThanhPho" formControlName="tenTinhThanhPho" />
            </div>
            <div class="mt-2">
                <label for="maTinhThanhPho">{{ '::MaTinhThanhPho' | abpLocalization }}</label><span> * </span>
                <input type="text" class="form-control" id="maTinhThanhPho" formControlName="maTinhThanhPho" />
            </div>
            <div class="mt-2">
                <label for="trangThai">{{ '::TrangThai' | abpLocalization }}</label><span> * </span>
                <select class="form-control" id="trangThai" formControlName="trangThai">
                    <option *ngFor="let opt of trangThaiOptions" [ngValue]="opt.value">
                        {{ opt.key | abpLocalization }}
                      </option>
                  </select>
            </div>
            <div class="mt-2">
                <label for="ghiChu">{{ '::GhiChu' | abpLocalization }}</label>
                <textarea class="form-control" id="ghiChu" formControlName="ghiChu"></textarea>
            </div>
            <button type="submit" class="btn btn-primary mt-2">{{ '::Save' | abpLocalization }}</button>
        </form>
    </ng-template>
</abp-modal>